В целом мой ответ совпадает по смыслу с примерами, с учётом языковых особенностей C# и платформы .NET.